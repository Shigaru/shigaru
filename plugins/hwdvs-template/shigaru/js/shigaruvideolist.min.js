(function(a){a.fn.shigaruVideoList=function(f){var m=a.extend({},a.fn.shigaruVideoList.defaults,f);var o=a(m.targetDiv);var d=a(m.userTargetDiv);var j=a(m.optionLinks);var b=j.find("a");var e=m.listURL;var w=false;var z="index.php?option=com_hwdvideoshare&task=ajax_userdetails&format=raw&user_id="+a("#user_id").val()+"&lang="+currentLang;var k="index.php?option=com_hwdvideoshare&task=ajax_setuserstatusmessage&format=raw&lang="+currentLang+"&user_id="+a("#user_id").val();var u="index.php?option=com_hwdvideoshare&task=ajax_usermenu&format=raw&lang="+currentLang+"&selected=&user_id="+a("#user_id").val();return this.each(function(){if(m.needsVideoListLoading){c();i(e);p()}if(m.needsHeaderProfile){h()}if(m.needsUserMenu){x()}});function g(D){var A=a("#mind");var E=A.val();if(E.length>0&&E.length<140){var F=D.find("i");var C=F.attr("class");F.removeClass().addClass("icon-spinner icon-spin");var B=a.post(k,{mind:E});B.done(function(G){d.find(".tcursive").empty().append(E);A.val("");F.removeClass().addClass(C);d.find("#statuscharcount").html("140").removeClass("fontred");d.find("#statuserror").hide();var H=a("#mind");H.next().fadeOut();H.animate({height:20})})}else{if(E.length>140){a("#statuserror").hide().find(".minlength").hide();a("#statuserror").fadeIn().find(".maxlength").show()}else{a("#statuserror").hide().find(".maxlength").hide();a("#statuserror").fadeIn().find(".minlength").show()}}}function h(){d.find(".loadingcontent").show();a.ajax({url:z}).done(function(A){d.html(A).find("a[title]").qtip({position:{show:{delay:2000},my:"top center",at:"bottom center",adjust:{x:0,y:25},target:"mouse"}});d.find(".loadingcontent").hide();d.fadeIn();d.find("a.close").click(function(B){B.preventDefault();a(this).parent().fadeOut()});d.find("#publishmind").click(function(B){B.preventDefault();g(a(this));B.stopPropagation()});a("body").click(function(){var B=a("#mind");B.next().fadeOut();B.animate({height:20})});a("#mind").focus(function(){$this=a(this);$this.animate({height:150},"slow");$this.next().fadeIn()}).keyup(function(){var C=a(this).val();var B=a("#statuscharcount");B.removeClass("fontred");B.html(140-C.length);if(C.length>140){B.addClass("fontred")}else{B.removeClass("fontred")}}).click(function(B){B.stopPropagation()});a(".profileoptions .btn").click(function(C){var B=a(this);B.parent().find("ul.dropdown-menu").toggle();return false})})}function x(){a.ajax({url:u}).done(function(A){var B=a(m.menuWrapper);B.hide().html(A).find("a[title]").qtip({position:{show:{delay:2000},my:"top center",at:"bottom center",adjust:{x:0,y:25},target:"mouse"}});B.find(".loadingcontent").hide();a(m.selectedUserMenu).addClass("active");B.fadeIn()})}function i(A){o.html('<div class="loadingcontent" style="line-height:600px"><i class="icon-spinner icon-spin"></i> Loading...</div>');var B=o.position();if(m.reScrollOnLoad){a("html, body").animate({scrollTop:B.top-50},"slow")}var C=A;if(a("#searchinput").val()){C+="&pattern="+a("#searchinput").val()}a(m.actionbars).block({message:null});a.ajax({url:C}).done(function(F){o.hide().html(F).find("a[title]").qtip({position:{show:{delay:2000},my:"top center",at:"bottom center",adjust:{x:0,y:25},target:"mouse"}});o.find("span[title]").qtip({position:{show:{delay:2000},my:"top center",at:"bottom center",adjust:{x:0,y:25},target:"mouse"}});var E=o.find(".videopagination").html();var D=o.find("#searchsummary").html();o.find(".videopagination").remove();o.find("#searchsummary").remove();o.fadeIn();a(m.paginationContainer).html(E);a("#searchsummarytext").html(D);o.find(".loadingcontent").hide();a(m.actionbars).unblock();y()})}function v(C){var A="";var B=C.target.href;console.log(B);if(B.indexOf("&limitstart=")>0){A=B.substring(B.indexOf("&limitstart="),C.target.href.length);console.log(A);if(A.indexOf("&")>0){A=A.substring(0,A.indexOf("&"))}A+="&limitstart="+A}console.log(e+A+r()+n());return e+A+r()+n()}function c(){a(m.filtersLinks).click(function(A){if(!a(A.target).is("input")){if(a(A.target).siblings().is(":checked")||a(A.target).parent().siblings().is(":checked")){a(A.target).siblings().attr("checked",false);a(A.target).parent().siblings().attr("checked",false)}else{a(A.target).siblings().attr("checked","checked");a(A.target).parent().siblings().attr("checked","checked")}A.preventDefault()}if(w){o.isotope("destroy")}i(e+n(A)+r())});a(m.filtersSelects).change(function(A){if(w){o.isotope("destroy")}i(e+n(A)+r())})}function n(){var A="&sort_by="+a("#sort_by").val();return A}function s(){a(m.paginationLinks).click(function(A){if(w){o.isotope("destroy")}i(v(A)+n(A)+r());A.preventDefault();return false})}function y(){if(o.find("#noresultswrapper").length==0){s();q(a("#resultcontainer .resultelement"));t(j.find(".active").attr("data-option-value"));o.isotope({itemSelector:".resultelement",masonry:{columnWidth:m.masonryColumnWidth},masonryHorizontal:{rowHeight:m.masonryHorizontalRowHeight},cellsByRow:{columnWidth:m.cellsByRowColumnWidth,rowHeight:m.cellsByRowRowHeight},layoutMode:j.find(".active").attr("data-option-value")},function(){w=true;a(".videolistoptions .btn").click(function(B){var A=a(this);A.toggleClass("active");A.next("ul.dropdown-menu").toggle();return false});a("body").click(function(){a(".videolistoptions ul.dropdown-menu").hide();if(a(".videolistoptions .btn").hasClass("active")){a(".videolistoptions .btn").removeClass("active")}})});a(".dropdown-menu .editvideobutton").click(function(A){A.preventDefault();a(this).prev().submit()});a(".dropdown-menu .deletevideobutton").click(function(B){B.preventDefault();var A=B;a.blockUI({message:'<p class="shigarunotice"><span id="close"></span>'+a("#deletevideomessage").html()+"</p>",css:{top:(a(window).height()-200)/2+"px",left:(a(window).width()-400)/2+"px",height:"200px",width:"400px","overflow-y:":"auto"}});a(".shigarunotice #close,.blockUI .cancel").click(function(C){C.preventDefault();a.unblockUI()});a(".blockUI .btn-danger").click(function(C){C.preventDefault();a(A.target).prev().submit()})})}else{}}function r(){var A="";a("#resultfilters .filter:visible").each(function(){if(a(this).hasClass("filtercheck")){var B=a(this).find("input:checked");if(B.length>0){A+="&"+a(this).attr("id")+"="}a(B).each(function(C){if(a(this).val()!=""){if(C==B.length-1){A+=a(this).val()}else{A+=a(this).val()+","}}})}else{var B=a(this).find("select");if(B.length>0){A+="&"+a(this).attr("id")+"="}a(B).each(function(C){if(a(this).val()){A+=a(this).val()}})}});return A}function q(A){A.find(".twolinestitle").show();A.find(".longtitle").hide();A.find(".searchResultInfo").hide().css({margin:"0","border-left":"none",padding:"0"}).parent().css("width","100%").prev().css("width","100%");A.css(m.layoutDefaultCss[0]);A.find("img.bradius5").css(m.layoutDefaultImgCss[0]).prev().css(m.layoutDefaultImgCss[0]);a(".searchResultInfo .extendedinfo").hide()}function t(A){var B=a("#resultcontainer .resultelement");switch(A){case"masonry":B.css(m.masonryCss[0]);B.find(".searchResultInfo").hide();B.find(".thumbplay").css("margin","20px 0 0 28px");break;case"cellsByRow":B.css(m.cellsByRowCss[0]).animate({width:"340px",height:"210px"});B.find("img.bradius5").css(m.cellsByRowImgCss[0]).prev().css(m.cellsByRowImgCss[0]).parent().next().css("margin-top","-20px");B.find(".thumbplay").css("margin","40px 0px 0px 55px");a(".searchResultInfo").css({"border-bottom":"none",margin:"3px 0 0 0","padding-bottom":"3px","padding-top":"0"}).show();break;case"straightDown":B.css(m.straightDownCss[0]).find(".searchResultInfo").addClass("fleft").prev().addClass("fleft");B.animate({width:"98%"});B.find("img.bradius5").css(m.straightDownImgCss[0]).prev().css(m.straightDownImgCss[0]).parent().next().css("margin-top","-20px");a(".searchResultInfo .extendedinfo").fadeIn();a(".searchResultInfo").css({"border-left":"1px dotted gray","border-bottom":"none","padding-left":"12px"}).show().parent().css("width","60%").prev().css("width","40%");B.find(".twolinestitle").hide();B.find(".longtitle").show();B.find(".thumbplay").css("margin","40px 0px 0px 55px");break}}function l(A,B){var C=a("#resultcontainer .resultelement");q(C);o.isotope(B);w=true;t(B.layoutMode)}function p(){b.click(function(){var E=a(this);if(E.hasClass("active")){return false}var C=E.parents(".btn-group");C.find(".active").removeClass("active");E.addClass("active");var A={},B=C.attr("data-option-key"),D=E.attr("data-option-value");D=D==="false"?false:D;A[B]=D;if(B==="layoutMode"&&typeof l==="function"){l(E,A)}else{o.isotope(A)}return false});a("#sort_by").change(function(A){if(w){o.isotope("destroy")}i(e+n(A)+r());A.preventDefault();return false})}};a.fn.shigaruVideoList.defaults={paginationLinks:"span.pagination a.page",targetDiv:"#resultcontainer",userTargetDiv:"#usersection",orderLinks:"#resultordering a",sortDefault:"relevance",optionLinks:"#options .btn-group",filtersLinks:"#resultfilters .filter .widget input,#resultfilters .filter .widget a",filtersSelects:"#resultfilters .filter .widget select",paginationContainer:".vidlistoptbar .vidlistpagination",actionbars:".vidlistoptbar",menuWrapper:"#usermenuwrapper",listURL:"index.php?option=com_hwdvideoshare&Itemid=29&task=displayresults&ajax=yes&format=raw&lang="+currentLang,masonryColumnWidth:275,masonryHorizontalRowHeight:200,cellsByRowColumnWidth:380,cellsByRowRowHeight:225,needsVideoListLoading:true,needsHeaderProfile:true,needsUserMenu:false,selectedUserMenu:"#whattowatch",reScrollOnLoad:false,layoutDefaultCss:[{width:"245px",height:"150px",fontSize:"100%",padding:"4px 0 0 0",border:"none",margin:0}],layoutDefaultImgCss:[{width:"98px"}],masonryCss:[{"border-bottom":"1px dotted gray",margin:"12px 0px 0px 4px"}],masonryImgCss:[{"border-bottom":"1px dotted gray",margin:"12px 0px 0px 4px"}],cellsByRowCss:[{"border-bottom":"1px dotted gray",fontSize:"100%","padding-top":"0",margin:"-12px 0 0 -12px"}],cellsByRowImgCss:[{width:"136px"}],straightDownCss:[{height:"140px",fontSize:"120%","border-bottom":"1px dotted gray",padding:"4px 2px 2px 0"}],straightDownImgCss:[{width:"133px"}]}})(jQuery);